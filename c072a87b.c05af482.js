(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{156:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return u})),n.d(t,"default",(function(){return b}));var a=n(2),o=n(9),i=(n(0),n(181)),s=n(176),c=n(177),r={id:"client-side-apps",title:"Client-side applications",image:"/img/client-scheme.png"},l={id:"advanced/client-side-apps",isDocsHomePage:!1,title:"Client-side applications",description:"The access token you get from your account page allow you to makes queries on the Trefle API, but you token needs to be kept secret, so you can't make queries from the browser as the user on your website will see the access token, and could use it for his personal uses.",source:"@site/docs/advanced/client-side-apps.md",permalink:"/docs/advanced/client-side-apps",editUrl:"https://github.com/treflehq/documentation/edit/master/docs/advanced/client-side-apps.md",lastUpdatedBy:"Andr\xe9 Aubin",lastUpdatedAt:1596111747,sidebar:"someSidebar",previous:{title:"Plants fields",permalink:"/docs/advanced/plants-fields"},next:{title:"Complete our data",permalink:"/docs/advanced/complete-data"}},u=[],d={rightToc:u};function b(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"The access token you get from ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://trefle.io/profile"}),"your account page")," allow you to makes queries on the Trefle API, but you token needs to be kept secret, so ",Object(i.b)("strong",{parentName:"p"},"you can't make queries from the browser as the user on your website will see the access token"),", and could use it for his personal uses."),Object(i.b)("p",null,Object(i.b)("img",Object(a.a)({parentName:"p"},{src:"/img/client-scheme.png",alt:"client workflow"}))),Object(i.b)("p",null,"If you need to perform client-side requests, you will have to request a client-side token from you backend, and get a JWT token in return. This token will be usable on the client side. This call need you secret access token, and the url of the website the client side requests will come from."),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"As this is a ",Object(i.b)("strong",{parentName:"p"},"POST")," request, it can't be done directly from the browser."))),Object(i.b)(s.a,{groupId:"supports",defaultValue:"browser",values:[{label:"CURL",value:"curl"},{label:"NodeJS",value:"node"}],mdxType:"Tabs"},Object(i.b)(c.a,{value:"curl",mdxType:"TabItem"},Object(i.b)("p",null,"In your terminal:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"curl -X POST 'https://trefle.io/api/auth/claim?token=YOUR_TREFLE_TOKEN&origin=YOUR-WEBSITE-URL&ip=12.34.56.78\"'\n"))),Object(i.b)(c.a,{value:"node",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const fetch = require('node-fetch');\n\n// The parameters for our POST request\nconst params = {\n  origin: 'YOUR-WEBSITE-URL',\n  ip: 'THE-WEBSITE-USER-IP',\n  token: 'YOUR_TREFLE_TOKEN'\n}\n\n(async () => {\n  const response = await fetch(\n    'https://trefle.io/api/auth/claim', {\n      method: 'post',\n      body: JSON.stringify(params),\n      headers: { 'Content-Type': 'application/json' }\n    });\n  const json = await response.json();\n  console.log(json);\n})();\n")))),Object(i.b)("p",null,"And we got:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxMDYsIm9yaWdpbiI6IllPVVItV0VCU0lURS1VUkwiLCJpcCI6IlRIRS1XRUJTSVRFLVVTRVItSVAiLCJleHAiOjE1OTQ2NDIxNDh9.Vd2d3UK7zdNWZLBOn8y50NcUKuF8xFZgh6p7EB4fhVw",\n  "expiration": "07-13-2020 14:09"\n}\n')),Object(i.b)("p",null,"You can then use this token directly from the browser. It can't be used from another origin, will expire and only works for your website."),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"About the user IP")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Putting the user remote IP in the claim API call is optionnal, but it provides an additional security layer. We don't keep or store this information."))))}b.isMDXComponent=!0},176:function(e,t,n){"use strict";n(25),n(21),n(20);var a=n(0),o=n.n(a),i=n(184),s=n(172),c=n(130),r=n.n(c),l=37,u=39;t.a=function(e){var t=e.block,n=e.children,c=e.defaultValue,d=e.values,b=e.groupId,p=Object(i.a)(),m=p.tabGroupChoices,h=p.setTabGroupChoices,O=Object(a.useState)(c),f=O[0],j=O[1];if(null!=b){var v=m[b];null!=v&&v!==f&&d.some((function(e){return e.value===v}))&&j(v)}var g=function(e){j(e),null!=b&&h(b,e)},w=[];return o.a.createElement("div",null,o.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(s.a)("tabs",{"tabs--block":t})},d.map((function(e){var t=e.value,n=e.label;return o.a.createElement("li",{role:"tab",tabIndex:"0","aria-selected":f===t,className:Object(s.a)("tabs__item",r.a.tabItem,{"tabs__item--active":f===t}),key:t,ref:function(e){return w.push(e)},onKeyDown:function(e){return function(e,t,n){switch(n.keyCode){case u:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case l:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(w,e.target,e)},onFocus:function(){return g(t)},onClick:function(){return g(t)}},n)}))),o.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},a.Children.toArray(n).filter((function(e){return e.props.value===f}))[0]))}},177:function(e,t,n){"use strict";var a=n(0),o=n.n(a);t.a=function(e){return o.a.createElement("div",null,e.children)}}}]);